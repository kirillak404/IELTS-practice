{% extends "layout.html" %}
{% block title %}
Speaking practice
{% endblock %}
{% block h1 %}
Speaking practice
{% endblock %}
{% block h1_classes %}
text-center
{% endblock %}
{% block content %}

<div class="container">
    <div class="content">
       <div class="d-flex justify-content-between flex-wrap mb-5">
            <div class="card card-metric">
                <div class="card-body card-metric-body">
                    <h5 class="card-title card-metric-title text-muted">Fluency and Coherence</h5>
                    <p class="card-score">{{ scores["Fluency and Coherence"] }}</p>
                </div>
            </div>
            <div class="card card-metric">
                <div class="card-body card-metric-body">
                    <h5 class="card-title card-metric-title text-muted">Lexical Resource</h5>
                    <p class="card-score">{{ scores["Lexical Resource"] }}</p>
                </div>
            </div>
            <div class="card card-metric">
                <div class="card-body card-metric-body">
                    <h5 class="card-title card-metric-title text-muted">Grammatical range and Accuracy</h5>
                    <p class="card-score">{{ scores["Grammatical range and Accuracy"] }}</p>
                </div>
            </div>
            <div class="card card-metric">
                <div class="card-body card-metric-body">
                    <h5 class="card-title card-metric-title text-muted">Pronunciation</h5>
                    <p class="card-score">{{ scores["Pronunciation"] }}</p>
                </div>
            </div>
        </div>
        {% for item in questions_and_answers %}
            <h5>{{item.question}}</h5>
            <p class="text-justify lead">{{item.answer|safe}}</p>
            <hr/>
        {% endfor %}
    </div>
</div>


<div class="toast">
    <div class="toast-header">
        <strong class="mr-auto"></strong> <!-- data-error-type will be inserted here -->
    </div>
    <div class="toast-body">
        <!-- Error explanation, wrong and corrected text will be inserted here -->
    </div>
</div>


<script>
$(document).ready(function() {
    $('.error').on('mouseenter', function(e) {
        $('.toast').stop();
        var top = e.pageY;
        var left = e.pageX;

        $('.toast').css({top: (top - $('.toast').height() - 10) + 'px', left: (left + 10) + 'px'});

        var errorType = $(this).data('error-type').charAt(0).toUpperCase() + $(this).data('error-type').slice(1);
        $('.toast-header strong').html(errorType);

        var struckText = '<span class="struck">' + $(this).text() + '</span>';
        var arrowIcon = '<i class="bi bi-arrow-right"></i>';
        var correctedText = '<span class="corrected">' + $(this).data('corrected-text') + '</span>';
        var explanation = '<br>' + $(this).data('error-long-description');
        $('.toast-body').html(struckText + ' ' + arrowIcon + ' ' + correctedText + explanation);

        $('.toast').fadeIn(250);
    });

    $('.error').on('mouseleave', function() {
        $('.toast').fadeOut(250);
    });
});
</script>


{% endblock %}