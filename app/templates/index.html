{% extends "layout.html" %}

{% block title %}
    Personal Account
{% endblock %}

{% block main %}
<h3>
  Hello üëã
  <small class="text-muted">Here's what you have</small>
</h3>
<br>
<h5>Cash: <mark>{{ cash | usd }}</mark></h5>
<h5>Stocks: <mark>{{ stocks_price | usd }}</mark></h5>
<h5>Total: <mark>{{ total | usd }}</mark></h5>
<br>

{% if stocks %}

<table class="table table-hover table-borderless text-start">
 <thead class="thead-light">
    <tr class="table-header">
      <th scope="col" >Symbol</th>
      <th scope="col">Name</th>
      <th scope="col">Shares</th>
      <th scope="col">Price</th>
      <th scope="col">Change</th>
      <th scope="col">TOTAL</th>
    </tr>
  </thead>
  <tbody>
  {% for stock in stocks %}

    <tr>
      <td>{{ stock["symbol"] }}</td>
      <td>{{ stock["name"] }}</td>
      <td>{{ stock["shares"] }}</td>
      <td>{{ stock["price"] | usd }}</td>
      <td class="price-change">{{ stock["price_diff_pers"] | percent }} ({{ stock["price_diff_abs"] | usd }})</td>
      <td>{{ stock["total_price"] | usd }}</td>
    </tr>

  {% endfor %}
  </tbody>
</table>


<script>
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –∫–ª–∞—Å—Å–æ–º "price-change"
    const priceChangeElements = document.querySelectorAll('.price-change');

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    priceChangeElements.forEach((element) => {
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
        const textContent = element.textContent;

        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–∞
        const value = parseFloat(textContent);

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è
        if (value < 0) {
            element.style.color = 'red';
        } else if (value > 0) {
            element.style.color = 'green';
        } else {
            element.style.color = 'black';
        }
    });
</script>


{% endif %}

{% endblock %}